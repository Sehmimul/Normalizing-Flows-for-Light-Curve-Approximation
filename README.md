# Final_Project
# PHYS449 Supernovae Classification by Light Curve Approximation

### Collaborators:
- name: Vishnu Mugundan
- student ID: 20823106

- name: Maimouna Sow
- student ID: 20822614

- name: Sehmimul Hoque
- student ID: 20814946

- name: Siddhardha Penmetsa
- student ID: 20924945

## Install Dependencies

- numpy
- matplotlib
- shutil
- torch
- fulu
- pandas
- sklearn
- joblib
- torchvision

Code to install requirements:
```sh
pip3 install -r requirements.txt
```

## Running `main.py`

To run `main.py`, use

```sh
python3 main.py
```

Get more information about the other arguments by running

```sh
python3 main.py --help
```

An example call of the program is

```sh
python main.py --param param/param.json -nf 10 -v -p
```

1. `-nf num_objects` runs Normalizing Flows to approximate `num_objects` light curves, and runs the CNN on the objects. In the above example, the code will produce 10 objects using Normalizing Flows, and run CNN on the 10 objects. `num_objects` must be at least 10. Be warned that even with multiprocessing implemented, the code takes a while to run.
2. `-v` increases the verbosity of the program.
3. `-p`produces plots for the light curves of the objects generated by Normalizing Flows.
4. `-s` shuffles the objects generated by Normalizing Flows. 

## Hyperparameters in `param/param.json`

### NF
- num_samples: 
- lr: Learning rate of the gradient descent
- n_epochs: Number of epochs for updating the parameters of the unknown model
- display_epochs: Number of epochs for printing the loss

### CNN
- n_epochs: Number of epochs for updating the parameters of the unknown model
- display_epochs: Number of epochs for printing the loss
- weight_decay: 
- lr: Learning rate of the gradient descent

## Data


