# Final_Project
# PHYS449 Supernovae Classification by Light Curve Approximation

### Collaborators:
- name: Vishnu Mugundan
- student ID: 20823106

- name: Maimouna Sow
- student ID: 20822614

- name: Sehmimul Hoque
- student ID: 20814946

- name: Siddhardha Penmetsa
- student ID: 20924945

## Install Dependencies

- numpy
- matplotlib
- torch
- fulu
- pandas
- sklearn
- joblib
- torchvision

Code to install requirements:
```sh
pip3 install -r requirements.txt
```

## Running `main.py`

To run `main.py`, use

```sh
python3 main.py
```

Get more information about the other arguments by running

```sh
python3 main.py --help
```

An example call of the program is

```sh
python main.py --param param/param.json -nf 10 -v -p
```

1. `-nf num_objects` runs Normalizing Flows to approximate `num_objects` light curves, and runs the CNN on the objects. In the above example, the code will produce 10 objects using Normalizing Flows, and run CNN on the 10 objects. `num_objects` must be at least 10. Be warned that even with multiprocessing implemented, the code takes a while to run.
2. `-v` increases the verbosity of the program.
3. `-p`produces plots for the light curves of the objects generated by Normalizing Flows.
4. `-s` shuffles the objects generated by Normalizing Flows. 

## Hyperparameters in `param/param.json`

### NF
- num_samples: 
- lr: Learning rate of the gradient descent
- n_epochs: Number of epochs for updating the parameters of the unknown model
- display_epochs: Number of epochs for printing the loss

### CNN
- n_epochs: Number of epochs for updating the parameters of the unknown model
- display_epochs: Number of epochs for printing the loss
- weight_decay: 
- lr: Learning rate of the gradient descent

## File Structure
- `main.py` : main running script
- `nfmetrics.csv` : contains metrics of flux approximation using normalizing flows
- `report.txt` : final report containing metrics for normalizing flows, training epochs of the CNN and metrics of CNN
- `requirements.txt` : requirements
- `src/normalizing_flows.py` : normalizing flows module
- `src/CNN.py` : CNN module
- `src/plot_utls.py` : plot utilities for normalizing flows
-  `src/cnn_metrics.py` : cnn metrics utilities
- `src/nf_metrics.py` : normalizing flows metrics utilities
- `src/X_matrix.json` : outputed flux and flux error for one full run of normalizing flows
- `src/y_vector.json` : supernovae binary prediction of objects in `src/X_matrix.json`
- `data/ANTARES_NEW.csv` : dataset containing relevant data for flux interpolation and flux type classification of 1870 objects
- `data/images.json` : flux and flux error for 600 objects using the normalzing flows algorithm (CNN can be trained on this data)
- `data/labels.json` : supernovae binary prediction of the 600 objects in `images.json`
- `param/param,json` : hyperparameters
- `plots`: contains plots of several flux interpolations using normalizing flows



